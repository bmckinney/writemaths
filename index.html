<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
		<title>Write maths, see maths!</title>

		<!-- MathJax -->
		<SCRIPT SRC="http://cdn.mathjax.org/mathjax/latest/MathJax.js">
		  MathJax.Hub.Config({
			extensions: ['tex2jax.js',"TeX/AMSmath.js","TeX/AMSsymbols.js"],
			tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},
			jax: ["input/TeX","output/HTML-CSS"],
			displayAlign: "center",
			displayIndent: "0.1em",
			showProcessingMessages: false
		  });
	  	</SCRIPT>

		<!-- jQuery -->
		<script type="text/javascript" src="jquery-1.6.js"></script>
		<script type="text/javascript" src="jquery.oembed.js"></script>
		<script type="text/javascript" src="jquery-ui-1.8.12.custom.min.js"></script>

		<!-- Numbas JME maths compiler/evaluator/renderer -->
		<script type="text/javascript" src="jme.js"></script>

		<!-- jsxGraph -->
		<script type="text/javascript" src="jsxgraphcore.js"></script>
		<link rel="stylesheet" type="text/css" href="jsxgraph.css" />

		<!-- generic writemaths code -->
		<script type="text/javascript" src="writemaths.js"></script>

		<!-- init writemaths area, hook up buttons -->
		<script language="javascript">
			var wm;
			$(window).ready(function() {
				var saveName = 'help';
				if(window.location && window.location.search)
				{
					saveName = window.location.search.slice(1);
				}

				//switch page
				$('#switch').submit(function(e) {
					e.stopPropagation();
					e.preventDefault();
					var name = $(this).find('input').val();
					changeSaveName(name);
					wm.load();
					$(this).find('input').blur();
				});

				$(window).bind('popstate',function(e) {
					var name = window.location.search.slice(1);
					if(name)
						changeSaveName(name,true);
					wm.load();
				});

				function changeSaveName(name,nopush)
				{
					if(!nopush && name!=saveName)
					{
						if(history && history.pushState)
							history.pushState({name: name},'['+name+'] Write maths, see maths!','?'+name);
						else
							document.location = '?'+name;
					}
					wm.saveName = saveName = name;
					$('#switch input, #saveas input').val(saveName);
					$('#switch input').val(saveName);
					var url = window.location.href;
					$('#url').attr('href',url).html(url);

					//recent pages auto-complete doodah
					var recent;
					try {
						recent = JSON.parse(localStorage['writemathsrecent']) || [];
					}
					catch(e) {
						recent = [];
					}
					if( (i=recent.indexOf(saveName)) >= 0 )
					{
						recent.splice(i,1);
					}
					recent.splice(0,0,saveName);
					recent = recent.slice(0,6);

					localStorage['writemathsrecent'] = JSON.stringify(recent);

					$('#switch input')
						.autocomplete({
							source: recent,
							minLength: 0,
							delay: 0,
							select: function(event,ui) { $(this).val(ui.item.value).submit(); }
						})
						.click(function() {

						})
						.focus(function() { this.select(); $(this).autocomplete('search','')})
						.mouseup(function(){ return false; })
					;
				}

				//save current page under different name
				$('#saveas').submit(function(e) {
					e.stopPropagation();
					e.preventDefault();
					changeSaveName($(this).find('input').val());
					wm.saveName = saveName;
					wm.saveState();
				});

				document.title = '['+saveName+'] Write maths, see maths!';

				wm = new WriteMaths('#writemaths',{
					display: '#printout',
					saveName: saveName
				});

				changeSaveName(saveName);

				$('#clear').click(function() {
					wm.setState('');
					wm.saveState();
				});
				$('#togglehtml').click(function() {
					wm.getHTML();
					var t = $('#printout').toggle().is(':visible') ? 'Hide HTML' : 'Show HTML';
					$('#togglehtml').val(t);
				});
			});
		</script>

		<link rel="stylesheet" type="text/css" href="jquery-ui.css" />
		<link rel="stylesheet" type="text/css" href="reset.css" />
		<link rel="stylesheet" type="text/css" href="typography.css" />
		<link rel="stylesheet" type="text/css" href="writemaths.css" />

	</head>
	<body>
		<div id="nav">
			<span>This page's URL: <a id="url"></a></span>
			<a href="?help">Help</a>
			<form id="switch">
				<label for="input">Page: </label><input id="input" type="text"></input>
			</form>
			<form id="saveas">
				<label for="input">Save as: </label><input id="input" type="text"></input>
			</form>
		</div>
		<div id="writemaths">
h1=. Write maths, see maths
h2. Idea
_Write maths, see maths_ is a sort-of-WYSIWYG editor for maths on the web.
It was created by "Christian Perfect":http://checkmyworking.com

h2. Input
Click on a line of text to edit it.
Press enter for a new paragraph.
Use the cursor keys to move between paragraphs quickly.
Write $m + a + t +h/s$
or ${\LaTeX}$
or "Textile":http://textile.thresholdstate.com

h2. Maths
Enclose maths in dollar signs, or in escaped square brackets for display mode: $e^(pi i)+1=0$ \[ e^(pi i) + 1 = 0 \]
Maths is converted from a simple (BASIC-style) syntax to LaTeX automatically. To keep raw LaTeX, enclose it in curly braces: \[ 1/2 {+ \sum_1^N \left( \frac{1}{n} \right) +} abs(y) \]

h2. Output
Click on the "Show HTML" button to get something you can copy and paste into a blog post or other web page (requires MathJax to be loaded on the page you paste it into)

h2. Graphs
Insert geometric drawings by writing "JessieScript":http://jsxgraph.uni-bayreuth.de/distrib/jessiescript_ref_en.pdf between double percent signs.
The triangle $ABC$ has centre $M$. 
%%A(1,1);B(-1,1);C(0,-1);[AB];[AC];[BC];D=1/2(A,B);E=1/2(A,C);F=1/2(B,C);]CD[;]BE[;]AF[;M=[CD]&[AF];%%
The equation of the circle with midpoint $(1,1)$ and radius $2$
%%A(1,1);k(A,2)%%
is \[ (x-1)^2+(y-1)^2 = 4 \]
		</div>
		<div id="controls">
			<input type="button" value="Clear" id="clear"/>
			<input type="button" value="Show HTML" id="togglehtml"/>
			<textarea id="printout" style="display:none;"></textarea>
		</div>
	</body>
</html>
